<!-- dashboard.html -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - ExamBlox</title>
  <link rel="icon" type="image/png" href="images/favicon.png">
  <link rel="stylesheet" href="Frontend/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
  <!-- STAR BACKGROUND -->
  <div class="stars"></div>

  <!-- Navigation -->
  <nav class="navbar">
    <div class="container">
      <div class="site-logo" onclick="goToHomepage()" style="cursor: pointer;">
        <i class="fas fa-book"></i>
        <h2 class="site-name">ExamBlox</h2>
      </div>
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="#" class="btn-login">Login</a></li>
        <li><a href="#" class="btn-signup">Sign Up</a></li>
      </ul>
      <div class="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </nav>

  <!-- Dashboard Container -->
  <div class="dashboard-container">
    <div class="container">
      <!-- Dashboard Header -->
      <div class="dashboard-header">
        <h1>Welcome back, <span id="user-name" style="font-size: inherit; color: var(--accent);">User</span>!</h1>
        <p>Track your learning progress and manage your study sessions</p>
      </div>

      <!-- Dashboard Stats -->
      <div class="dashboard-stats">
        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-question-circle"></i></div>
          <div class="stat-content">
            <h3 id="total-questions">0</h3>
            <p>Questions Generated</p>
          </div>
        </div>
        
        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-file-alt"></i></div>
          <div class="stat-content">
            <h3 id="files-processed">0</h3>
            <p>Files Processed</p>
          </div>
        </div>
        
        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-chart-line"></i></div>
          <div class="stat-content">
            <h3 id="avg-score">0%</h3>
            <p>Average Score</p>
          </div>
        </div>
        
        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-calendar-check"></i></div>
          <div class="stat-content">
            <h3 id="study-sessions">0</h3>
            <p>Study Sessions</p>
          </div>
        </div>
      </div>

      <!-- Recent Activities -->
      <div class="dashboard-section">
        <h2>Recent Activities</h2>
        <div class="activities-container" id="activities-list">
          <div class="activity-item placeholder">
            <div class="activity-icon"><i class="fas fa-info-circle"></i></div>
            <div class="activity-content">
              <p>No activities yet. Start by uploading a document and generating questions!</p>
              <small>Upload your first file to get started</small>
            </div>
          </div>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="dashboard-section">
        <h2>Quick Actions</h2>
        <div class="quick-actions">
          <a href="index.html" class="action-card">
            <div class="action-icon"><i class="fas fa-plus-circle"></i></div>
            <h3>Generate New Questions</h3>
            <p>Upload documents and create practice questions</p>
          </a>
          
          <div class="action-card" onclick="showUpgradeModal()">
            <div class="action-icon"><i class="fas fa-crown"></i></div>
            <h3>Upgrade Plan</h3>
            <p>Get unlimited questions and advanced features</p>
          </div>
          
          <div class="action-card" onclick="showSettingsModal()">
            <div class="action-icon"><i class="fas fa-cog"></i></div>
            <h3>Account Settings</h3>
            <p>Manage your profile and preferences</p>
          </div>
        </div>
      </div>

      <!-- Plan Information -->
      <div class="dashboard-section">
        <h2>Your Plan</h2>
        <div class="plan-info">
          <div class="plan-card">
            <h3 id="current-plan">Free Plan</h3>
            <div class="plan-usage">
              <div class="usage-item">
                <span>Questions this month:</span>
                <span id="monthly-questions">0 / 50</span>
              </div>
              <div class="usage-item">
                <span>Files uploaded:</span>
                <span id="monthly-files">0 / 5</span>
              </div>
            </div>
            <div class="plan-progress">
              <div class="progress-bar">
                <div class="progress-fill" id="usage-progress" style="width: 0%"></div>
              </div>
              <p id="usage-text">0% of monthly limit used</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <style>
    /* Dashboard Specific Styles */
    .dashboard-container {
      background: var(--darker);
      min-height: 100vh;
      padding-top: clamp(100px, 15vh, 140px);
      padding-bottom: var(--spacing-2xl);
    }

    .dashboard-header {
      text-align: center;
      margin-bottom: var(--spacing-2xl);
    }

    .dashboard-header h1 {
      color: var(--primary-light);
      margin-bottom: var(--spacing-sm);
    }

    .dashboard-header span {
      color: var(--accent);
    }

    .dashboard-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: var(--spacing-lg);
      margin-bottom: var(--spacing-2xl);
    }

    .stat-card {
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: var(--spacing-lg);
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s;
    }

    .stat-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .stat-icon {
      width: 60px;
      height: 60px;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--primary), var(--primary-light));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: white;
    }

    .stat-content h3 {
      font-size: 2rem;
      margin-bottom: 4px;
      color: var(--text);
    }

    .stat-content p {
      color: var(--text-secondary);
      font-size: var(--font-size-sm);
      margin: 0;
    }

    .dashboard-section {
      margin-bottom: var(--spacing-2xl);
    }

    .dashboard-section h2 {
      text-align: left;
      margin-bottom: var(--spacing-lg);
      color: var(--text);
      background: none;
      -webkit-text-fill-color: inherit;
    }

    .activities-container {
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      max-height: 400px;
      overflow-y: auto;
    }

    .activity-item {
      padding: var(--spacing-md);
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
    }

    .activity-item:last-child {
      border-bottom: none;
    }

    .activity-item.placeholder {
      justify-content: center;
      text-align: center;
      opacity: 0.7;
    }

    .activity-icon {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      background: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1rem;
    }

    .activity-content p {
      margin: 0 0 4px 0;
      color: var(--text);
    }

    .activity-content small {
      color: var(--text-secondary);
    }

    .quick-actions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: var(--spacing-lg);
    }

    .action-card {
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: var(--spacing-lg);
      text-decoration: none;
      color: var(--text);
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s;
      cursor: pointer;
      text-align: center;
    }

    .action-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
      border-color: var(--primary);
    }

    .action-icon {
      width: 60px;
      height: 60px;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--accent), var(--primary));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: white;
      margin: 0 auto var(--spacing-md);
    }

    .action-card h3 {
      margin-bottom: var(--spacing-sm);
      color: var(--text);
    }

    .action-card p {
      color: var(--text-secondary);
      font-size: var(--font-size-sm);
      margin: 0;
    }

    .plan-info {
      max-width: 600px;
    }

    .plan-card {
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: var(--spacing-xl);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .plan-card h3 {
      color: var(--primary-light);
      margin-bottom: var(--spacing-lg);
      text-align: center;
    }

    .plan-usage {
      margin-bottom: var(--spacing-lg);
    }

    .usage-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: var(--spacing-sm);
      color: var(--text);
    }

    .plan-progress {
      text-align: center;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: var(--spacing-sm);
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      border-radius: 10px;
      transition: width 0.3s ease;
    }

    #usage-text {
      color: var(--text-secondary);
      font-size: var(--font-size-sm);
      margin: 0;
    }

    @media (max-width: 768px) {
      .dashboard-stats {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: var(--spacing-md);
      }

      .quick-actions {
        grid-template-columns: 1fr;
      }
    }
  </style>

  <script src="Frontend/script.js"></script>
  <script>
    // Dashboard-specific functionality
    document.addEventListener('DOMContentLoaded', function() {
      loadDashboardData();
    });

    function loadDashboardData() {
      // Check if user is logged in
      if (!isUserLoggedIn) {
        window.location.href = 'index.html';
        return;
      }

      // Update user name
      document.getElementById('user-name').textContent = currentUser.name || currentUser.email;

      // Load user stats (from localStorage for now)
      const userStats = JSON.parse(localStorage.getItem('examblox_user_stats') || '{}');
      
      document.getElementById('total-questions').textContent = userStats.totalQuestions || 0;
      document.getElementById('files-processed').textContent = userStats.filesProcessed || 0;
      document.getElementById('avg-score').textContent = (userStats.averageScore || 0) + '%';
      document.getElementById('study-sessions').textContent = userStats.studySessions || 0;

      // Plan information
      document.getElementById('current-plan').textContent = (currentUser.plan || 'free').toUpperCase() + ' Plan';
      document.getElementById('monthly-questions').textContent = `${userStats.monthlyQuestions || 0} / ${currentUser.plan === 'premium' ? 'Unlimited' : '50'}`;
      document.getElementById('monthly-files').textContent = `${userStats.monthlyFiles || 0} / ${currentUser.plan === 'premium' ? 'Unlimited' : '5'}`;
      
      if (currentUser.plan !== 'premium') {
        const usage = ((userStats.monthlyQuestions || 0) / 50) * 100;
        document.getElementById('usage-progress').style.width = usage + '%';
        document.getElementById('usage-text').textContent = Math.round(usage) + '% of monthly limit used';
      }

      // Load recent activities
      loadRecentActivities();
    }

    function loadRecentActivities() {
      const activities = JSON.parse(localStorage.getItem('examblox_activities') || '[]');
      const container = document.getElementById('activities-list');
      
      if (activities.length === 0) return;

      container.innerHTML = '';
      activities.slice(0, 5).forEach(activity => {
        const item = document.createElement('div');
        item.className = 'activity-item clickable';
        item.style.cursor = 'pointer';
        item.onclick = () => viewPreviousQuestions(activity);
        
        item.innerHTML = `
          <div class="activity-icon"><i class="${activity.icon}"></i></div>
          <div class="activity-content">
            <p>${activity.title}</p>
            <small>${activity.date}</small>
          </div>
          <div class="activity-action">
            <i class="fas fa-chevron-right" style="color: var(--primary-light);"></i>
          </div>
        `;
        container.appendChild(item);
      });
    }

    function viewPreviousQuestions(activity) {
      if (activity.questions && activity.questions.length > 0) {
        // Store the questions for viewing
        const questionData = {
          questions: activity.questions,
          metadata: {
            fileName: activity.details.files.join(', '),
            questionType: activity.details.questionType,
            difficulty: activity.details.difficulty,
            totalQuestions: activity.questions.length,
            isReview: true,
            reviewTitle: `Review: ${activity.title}`
          }
        };
        
        localStorage.setItem('examblox_questions', JSON.stringify(questionData));
        window.location.href = 'questions.html';
      } else {
        alert('Questions data not available for this activity.');
      }
    }

    function showUpgradeModal() {
      alert('Upgrade feature coming soon!');
    }

    function showSettingsModal() {
      alert('Settings feature coming soon!');
    }
  </script>
</body>
</html>
